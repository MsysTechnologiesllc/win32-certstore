<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!file.README.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'>
<h1 id="label-win32-certstore">win32-certstore</h1>

<p>Ruby library for accessing the certificate store on Microsoft Windows:</p>

<h2 id="label-Subcommands">Subcommands</h2>

<p>This library provides the following features.</p>

<h3 id="label-Open+certificate+store">Open certificate store</h3>

<p>Any valid certificate store can be opened in two ways:</p>

<p><strong>Notes: Valid certificate store
names:#&lt;RDoc::Markup::HardBreak:0x0000000184acf0&gt; <code>CA -&gt;
Certification authority
certificates.</code>#&lt;RDoc::Markup::HardBreak:0x0000000184acf0&gt;
<code>MY -&gt; A certificate store that holds certificates with associated
private keys.</code>#&lt;RDoc::Markup::HardBreak:0x0000000184acf0&gt;
<code>ROOT -&gt; Root
certificates.</code>#&lt;RDoc::Markup::HardBreak:0x0000000184acf0&gt;
<code>SPC -&gt; Software Publisher Certificate.</code></strong></p>

<pre class="code ruby"><code class="ruby">Win32::Certstore.open(&quot;Root&quot;) do |store|
    //your code should be here!
end</code></pre>

<pre class="code ruby"><code class="ruby">or</code></pre>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='const'>Win32</span><span class='op'>::</span><span class='const'>Certstore</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Root</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</code></pre>

<h3 id="label-Add+certificate">Add certificate</h3>

<p>Add a valid certificate in a certificate store.</p>

<p><strong>Notes: The new certificate should be converted in OpenSSL::X509
:</strong></p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C:\GlobalSignRootCA.pem</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_certificate_object'>certificate_object</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Certificate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_raw'>raw</span>

<span class='const'>Win32</span><span class='op'>::</span><span class='const'>Certstore</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Root</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_store'>store</span><span class='op'>|</span>
  <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='id identifier rubyid_certificate_object'>certificate_object</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span>
</code></pre>

<pre class="code ruby"><code class="ruby">or</code></pre>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C:\GlobalSignRootCA.pem</span><span class='tstring_end'>&quot;</span></span> 
<span class='id identifier rubyid_certificate_object'>certificate_object</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Certificate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_raw'>raw</span>

<span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='const'>Win32</span><span class='op'>::</span><span class='const'>Certstore</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Root</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='id identifier rubyid_certificate_object'>certificate_object</span><span class='rparen'>)</span>
<span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
</code></pre>

<h3 id="label-List+certificates">List certificates</h3>

<p>Lists certificates of a valid certificate store and returns output in JSON
format:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Win32</span><span class='op'>::</span><span class='const'>Certstore</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Root</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_store'>store</span><span class='op'>|</span>
    <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span>
    <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span>
</code></pre>

<pre class="code ruby"><code class="ruby">or</code></pre>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='const'>Win32</span><span class='op'>::</span><span class='const'>Certstore</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Root</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span>
<span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
</code></pre>

<h3 id="label-Delete+certificate">Delete certificate</h3>

<p>Deletes a certificate from certificate store and returns output in string
format.</p>

<p><strong>Notes: The certificate_name should be valid <code>CN or Common
Name</code> of the certificate :</strong></p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_certificate_name'>certificate_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Root Agency</span><span class='tstring_end'>&#39;</span></span>
<span class='const'>Win32</span><span class='op'>::</span><span class='const'>Certstore</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Root</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_store'>store</span><span class='op'>|</span>
    <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_certificate_name'>certificate_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span>
</code></pre>

<pre class="code ruby"><code class="ruby">or</code></pre>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='const'>Win32</span><span class='op'>::</span><span class='const'>Certstore</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Root</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_certificate_name'>certificate_name</span><span class='rparen'>)</span>
<span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
</code></pre>

<h3 id="label-Retrieve+certificate">Retrieve certificate</h3>

<p>Retrieve properties of a certificate from certificate store and returns
output in hash format.</p>

<p><strong>Notes: The certificate_name should be valid <code>CN or Common
Name</code> of the certificate</strong></p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_certificate_name'>certificate_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GlobalSign Root CA</span><span class='tstring_end'>&#39;</span></span>
<span class='const'>Win32</span><span class='op'>::</span><span class='const'>Certstore</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Root</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_store'>store</span><span class='op'>|</span>
    <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_retrieve'>retrieve</span><span class='lparen'>(</span><span class='id identifier rubyid_certificate_name'>certificate_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span>
</code></pre>

<pre class="code ruby"><code class="ruby">or</code></pre>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='const'>Win32</span><span class='op'>::</span><span class='const'>Certstore</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Root</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_retrieve'>retrieve</span><span class='lparen'>(</span><span class='id identifier rubyid_certificate_name'>certificate_name</span><span class='rparen'>)</span>
<span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
</code></pre>

<h3 id="label-Perform+multiple+operations">Perform multiple operations</h3>

<p>You can perform more that one oprations with single certificate store
object</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C:\GlobalSignRootCA.pem</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_certificate_object'>certificate_object</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Certificate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_raw'>raw</span>

<span class='const'>Win32</span><span class='op'>::</span><span class='const'>Certstore</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Root</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_store'>store</span><span class='op'>|</span>
  <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='id identifier rubyid_certificate_object'>certificate_object</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span>
  <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span>
</code></pre>

<pre class="code ruby"><code class="ruby">or</code></pre>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_raw'>raw</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>C:\GlobalSignRootCA.pem</span><span class='tstring_end'>&quot;</span></span> 
<span class='id identifier rubyid_certificate_object'>certificate_object</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Certificate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_raw'>raw</span>

<span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='const'>Win32</span><span class='op'>::</span><span class='const'>Certstore</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Root</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='id identifier rubyid_certificate_object'>certificate_object</span><span class='rparen'>)</span>
<span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span>
<span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
</code></pre>

<h2 id="label-Requirements+-2F+setup">Requirements / setup</h2>

<h3 id="label-Ruby">Ruby</h3>

<p>Ruby 1.9.3+ is required.</p>

<h2 id="label-CONTRIBUTING-3A">CONTRIBUTING:</h2>

<p>Please file bugs against the WIN32-CERTSTORE project at <a
href="https://github.com/chef/win32-certstore/issues">github.com/chef/win32-certstore/issues</a>.</p>

<p>More information on the contribution process for Chef projects can be found
in the <a href="http://docs.chef.io/community_contributions.html">Chef
Contributions document</a>.</p>

<h1 id="label-LICENSE-3A">LICENSE:</h1>

<p>Author:: Bryan McLellan (<a href="mailto:btm@chef.io">btm@chef.io</a>)
Copyright:: 2017-2018 Chef Software, Inc. License:: Apache License, Version
2.0</p>

<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not
use this file except in compliance with the License. You may obtain a copy
of the License at</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_http'>http</span><span class='symbol'>:/</span><span class='op'>/</span><span class='id identifier rubyid_www'>www</span><span class='period'>.</span><span class='id identifier rubyid_apache'>apache</span><span class='period'>.</span><span class='id identifier rubyid_org'>org</span><span class='op'>/</span><span class='id identifier rubyid_licenses'>licenses</span><span class='op'>/</span><span class='const'>LICENSE</span><span class='op'>-</span><span class='float'>2.0</span>
</code></pre>

<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an “AS IS” BASIS, WITHOUT
WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
License for the specific language governing permissions and limitations
under the License.</p>
</div></div>

    <div id="footer">
  Generated on Thu Mar 29 16:46:38 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.4.1).
</div>

  </body>
</html>